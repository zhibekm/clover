
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Autonomous Multirotor Landing System (AMLS) · Clover</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Copter Express">
        
        
    
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-richquotes/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-image-zoom/zoom.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-language-picker/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

    
    <link rel="stylesheet" type="text/css" href="../clover.css" />
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="clever-show.html" />
    
    
    <link rel="prev" href="projects.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="glossary.html">
            
                <a href="glossary.html">
            
                    
                    Glossary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="safety.html">
            
                <a href="safety.html">
            
                    
                    Safety tips
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="assembly.html">
            
                <a href="assembly.html">
            
                    
                    Assembly
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="assemble_4_2.html">
            
                <a href="assemble_4_2.html">
            
                    
                    Clover 4.2 assembly
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="assemble_4_2_ws.html">
            
                <a href="assemble_4_2_ws.html">
            
                    
                    Clover 4.2 WorldSkills
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="assemble_4.html">
            
                <a href="assemble_4.html">
            
                    
                    Clover 4 assembly
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="assemble_3.html">
            
                <a href="assemble_3.html">
            
                    
                    Clover 3 assembly
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="assemble_2.html">
            
                <a href="assemble_2.html">
            
                    
                    Clover 2 assembly
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="setup.html">
            
                <a href="setup.html">
            
                    
                    Configuration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="calibration.html">
            
                <a href="calibration.html">
            
                    
                    Sensor calibration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="radio.html">
            
                <a href="radio.html">
            
                    
                    RC setup
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="rc_flysky_a8s.html">
            
                <a href="rc_flysky_a8s.html">
            
                    
                    Using FS-A8S
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="modes.html">
            
                <a href="modes.html">
            
                    
                    Flight modes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="power.html">
            
                <a href="power.html">
            
                    
                    Power setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="failsafe.html">
            
                <a href="failsafe.html">
            
                    
                    Failsafe configuration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="flight.html">
            
                <a href="flight.html">
            
                    
                    Manual flight
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="flight.html">
            
                <a href="flight.html">
            
                    
                    Basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="flight_exercises.html">
            
                <a href="flight_exercises.html">
            
                    
                    Exercises
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="raspberry.html">
            
                <a href="raspberry.html">
            
                    
                    Working with Raspberry Pi
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="image.html">
            
                <a href="image.html">
            
                    
                    RPi Image
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="wifi.html">
            
                <a href="wifi.html">
            
                    
                    Wi-Fi connection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="connection.html">
            
                <a href="connection.html">
            
                    
                    Connection to the Pixracer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="gcs_bridge.html">
            
                <a href="gcs_bridge.html">
            
                    
                    Using QGroundControl over Wi-Fi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="ssh.html">
            
                <a href="ssh.html">
            
                    
                    Remote shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="cli.html">
            
                <a href="cli.html">
            
                    
                    Command line interface
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="selfcheck.html">
            
                <a href="selfcheck.html">
            
                    
                    Automated self-checks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="web_video_server.html">
            
                <a href="web_video_server.html">
            
                    
                    Viewing images from cameras
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="programming.html">
            
                <a href="programming.html">
            
                    
                    Programming
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="camera_setup.html">
            
                <a href="camera_setup.html">
            
                    
                    Camera setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="aruco.html">
            
                <a href="aruco.html">
            
                    
                    Fiducial markers (ArUco)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1" data-path="aruco_marker.html">
            
                <a href="aruco_marker.html">
            
                    
                    Marker detection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2" data-path="aruco_map.html">
            
                <a href="aruco_map.html">
            
                    
                    Map-based navigation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="optical_flow.html">
            
                <a href="optical_flow.html">
            
                    
                    Optical Flow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="simple_offboard.html">
            
                <a href="simple_offboard.html">
            
                    
                    Autonomous flight (OFFBOARD)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="frames.html">
            
                <a href="frames.html">
            
                    
                    Coordinate systems (frames)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.6" data-path="snippets.html">
            
                <a href="snippets.html">
            
                    
                    Code snippets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.7" data-path="laser.html">
            
                <a href="laser.html">
            
                    
                    Interfacing with a laser rangefinder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.8" data-path="leds.html">
            
                <a href="leds.html">
            
                    
                    LED strip
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.9" data-path="gpio.html">
            
                <a href="gpio.html">
            
                    
                    Working with GPIO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.10" data-path="sonar.html">
            
                <a href="sonar.html">
            
                    
                    Interfacing with a sonar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.11" data-path="camera.html">
            
                <a href="camera.html">
            
                    
                    Computer vision basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.12" data-path="rviz.html">
            
                <a href="rviz.html">
            
                    
                    Using rviz and rqt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.13" data-path="autolaunch.html">
            
                <a href="autolaunch.html">
            
                    
                    Software autorun
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.14" data-path="javascript.html">
            
                <a href="javascript.html">
            
                    
                    Using JavaScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.15" data-path="blocks.html">
            
                <a href="blocks.html">
            
                    
                    Blocks programming
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.16" data-path="simulation.html">
            
                <a href="simulation.html">
            
                    
                    Simulation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.16.1" data-path="simulation_native.html">
            
                <a href="simulation_native.html">
            
                    
                    Native setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.16.2" data-path="simulation_vm.html">
            
                <a href="simulation_vm.html">
            
                    
                    VM setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.16.3" data-path="simulation_usage.html">
            
                <a href="simulation_usage.html">
            
                    
                    Usage
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.17" data-path="ros.html">
            
                <a href="ros.html">
            
                    
                    ROS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.18" data-path="mavros.html">
            
                <a href="mavros.html">
            
                    
                    MAVROS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="supplementary.html">
            
                <a href="supplementary.html">
            
                    
                    Supplementary materials
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="coex_pix.html">
            
                <a href="coex_pix.html">
            
                    
                    COEX Pix
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="coex_pdb.html">
            
                <a href="coex_pdb.html">
            
                    
                    COEX PDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="coex_gps.html">
            
                <a href="coex_gps.html">
            
                    
                    COEX GPS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="auto_setup.html">
            
                <a href="auto_setup.html">
            
                    
                    Guide on autonomous flight
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="hostname.html">
            
                <a href="hostname.html">
            
                    
                    Hostname
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="sitl.html">
            
                <a href="sitl.html">
            
                    
                    PX4 Simulation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="wall_aruco.html">
            
                <a href="wall_aruco.html">
            
                    
                    Navigation using vertical ArUco-markers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="calibratePID.html">
            
                <a href="calibratePID.html">
            
                    
                    PID Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="models.html">
            
                <a href="models.html">
            
                    
                    Model files for parts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.10" data-path="ros-install.html">
            
                <a href="ros-install.html">
            
                    
                    ROS Melodic installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.11" data-path="camera_calibration.html">
            
                <a href="camera_calibration.html">
            
                    
                    Camera calibration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.12" data-path="zerotire_vpn.html">
            
                <a href="zerotire_vpn.html">
            
                    
                    VPN ZeroTire Connection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.13" data-path="4g.html">
            
                <a href="4g.html">
            
                    
                    Quadcopter control with 4G communication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.14" data-path="jetson_nano.html">
            
                <a href="jetson_nano.html">
            
                    
                    Clover and Jetson Nano
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.15" data-path="rc.html">
            
                <a href="rc.html">
            
                    
                    Remote control app
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.16" data-path="network.html">
            
                <a href="network.html">
            
                    
                    Wi-Fi Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.17" data-path="uart.html">
            
                <a href="uart.html">
            
                    
                    UART settings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.18" data-path="px4_parameters.html">
            
                <a href="px4_parameters.html">
            
                    
                    PX4 Parameters
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.19" data-path="flight_logs.html">
            
                <a href="flight_logs.html">
            
                    
                    PX4 Logs and Topics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.20" data-path="firmware.html">
            
                <a href="firmware.html">
            
                    
                    PX4 Firmware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.21" data-path="mavlink.html">
            
                <a href="mavlink.html">
            
                    
                    MAVLink
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.22" data-path="test_connection.html">
            
                <a href="test_connection.html">
            
                    
                    Multimeter usage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.23" data-path="radioerrors.html">
            
                <a href="radioerrors.html">
            
                    
                    RC Troubleshooting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.24" data-path="esc_firmware.html">
            
                <a href="esc_firmware.html">
            
                    
                    Flashing ESCs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.25" data-path="arduino.html">
            
                <a href="arduino.html">
            
                    
                    Interfacing with Arduino
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.26" data-path="gps.html">
            
                <a href="gps.html">
            
                    
                    Connecting GPS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.27" data-path="ir_sensors.html">
            
                <a href="ir_sensors.html">
            
                    
                    Working with IR sensors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.28" data-path="fpv_clover_4_2.html">
            
                <a href="fpv_clover_4_2.html">
            
                    
                    FPV Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.29" data-path="fpv.html">
            
                <a href="fpv.html">
            
                    
                    FPV Setup (Clover 3)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.30" data-path="magnetic_grip.html">
            
                <a href="magnetic_grip.html">
            
                    
                    Magnetic grip
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.31" data-path="mechanical_grip.html">
            
                <a href="mechanical_grip.html">
            
                    
                    Mechanical grip
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.32" data-path="trainer_mode.html">
            
                <a href="trainer_mode.html">
            
                    
                    Trainer mode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.33" data-path="tinning.html">
            
                <a href="tinning.html">
            
                    
                    Tinning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.34" data-path="connectortypes.html">
            
                <a href="connectortypes.html">
            
                    
                    Types of power connectors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.35" data-path="4in1.html">
            
                <a href="4in1.html">
            
                    
                    Connecting 4 in 1 ESCs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.36" data-path="tb.html">
            
                <a href="tb.html">
            
                    
                    Soldering safety
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.37" data-path="leds_old.html">
            
                <a href="leds_old.html">
            
                    
                    LED strip (legacy)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.38" data-path="contributing.html">
            
                <a href="contributing.html">
            
                    
                    Contribution Guidelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.39" data-path="packages.html">
            
                <a href="packages.html">
            
                    
                    COEX packages repository
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.40" data-path="migrate20.html">
            
                <a href="migrate20.html">
            
                    
                    Migration to v0.20
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.41" data-path="migrate22.html">
            
                <a href="migrate22.html">
            
                    
                    Migration to v0.22
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="events.html">
            
                <a href="events.html">
            
                    
                    Events
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="copterhack2022.html">
            
                <a href="copterhack2022.html">
            
                    
                    CopterHack-2022
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="copterhack2021.html">
            
                <a href="copterhack2021.html">
            
                    
                    CopterHack-2021
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="copterhack2019.html">
            
                <a href="copterhack2019.html">
            
                    
                    CopterHack-2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="copterhack2018.html">
            
                <a href="copterhack2018.html">
            
                    
                    CopterHack-2018
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="copterhack2017.html">
            
                <a href="copterhack2017.html">
            
                    
                    CopterHack-2017
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="projects.html">
            
                <a href="projects.html">
            
                    
                    Clover-based projects
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.11.1" data-path="amls.html">
            
                <a href="amls.html">
            
                    
                    Autonomous Multirotor Landing System (AMLS)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="clever-show.html">
            
                <a href="clever-show.html">
            
                    
                    Drone show
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="innopolis_open_L22_AERO.html">
            
                <a href="innopolis_open_L22_AERO.html">
            
                    
                    Innopolis Open 2020 (L22_ÆRO)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="shield.html">
            
                <a href="shield.html">
            
                    
                    Copter spheric guard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="face_recognition.html">
            
                <a href="face_recognition.html">
            
                    
                    Face recognition system
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.6" data-path="android.html">
            
                <a href="android.html">
            
                    
                    Android RC app
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7" data-path="3dscan.html">
            
                <a href="3dscan.html">
            
                    
                    3D-scanning drone
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.8" data-path="human_pose_estimation_drone_control.html">
            
                <a href="human_pose_estimation_drone_control.html">
            
                    
                    Human pose estimation drone control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9" data-path="robocross2019.html">
            
                <a href="robocross2019.html">
            
                    
                    Robocross-2019
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.10" data-path="camera_calib.html">
            
                <a href="camera_calib.html">
            
                    
                    Camera calibration (legacy)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.11" data-path="agriculture.html">
            
                <a href="agriculture.html">
            
                    
                    Recognition of crop types in agriculture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.12" data-path="anticorona_drones.html">
            
                <a href="anticorona_drones.html">
            
                    
                    Drones to fight Coronavirus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.13" data-path="ddrone.html">
            
                <a href="ddrone.html">
            
                    
                    D-drone Copter Hack 2021 by AT Makers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.14" data-path="generative_design_frame.html">
            
                <a href="generative_design_frame.html">
            
                    
                    3D-printed Generative Design Frame
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.15" data-path="bennie.html">
            
                <a href="bennie.html">
            
                    
                    Retail Drone
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.16" data-path="dromap.html">
            
                <a href="dromap.html">
            
                    
                    The Indoor Mapping Drone
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.17" data-path="seeding_drone.html">
            
                <a href="seeding_drone.html">
            
                    
                    Seeding Drone
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.18" data-path="blue_jay_eindhoven.html">
            
                <a href="blue_jay_eindhoven.html">
            
                    
                    Blue Jay Eindhoven
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Autonomous Multirotor Landing System (AMLS)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="autonomous-multirotor-landing-system-amls"><a name="autonomous-multirotor-landing-system-amls" class="plugin-anchor" href="#autonomous-multirotor-landing-system-amls"><i class="fa fa-link" aria-hidden="true"></i></a>Autonomous Multirotor Landing System (AMLS)</h1>
<p><img src="../assets/amls/logo_book.png" alt="Logo" title="Logo"></p>
<h2 id="the-goal-is-to-automatically-land-a-drone-on-a-moving-platform"><a name="the-goal-is-to-automatically-land-a-drone-on-a-moving-platform" class="plugin-anchor" href="#the-goal-is-to-automatically-land-a-drone-on-a-moving-platform"><i class="fa fa-link" aria-hidden="true"></i></a>The goal is to automatically land a drone on a moving platform</h2>
<h3 id="amls-article"><a name="amls-article" class="plugin-anchor" href="#amls-article"><i class="fa fa-link" aria-hidden="true"></i></a>AMLS Article</h3>
<p>In this Article we will describe AMLS project. Namely, AMLS Optical stabilization, GPS holding, GPS following, Altitude holding, Grabbing, Weather protection, Speed measurement and Illumination systems. In addition, we will make clear of how it works and how it was done!</p>
<h3 id="our-main-github-repository"><a name="our-main-github-repository" class="plugin-anchor" href="#our-main-github-repository"><i class="fa fa-link" aria-hidden="true"></i></a>Our main GitHub repository</h3>
<p><a href="https://github.com/XxOinvizioNxX/Liberty-Way" target="_blank">https://github.com/XxOinvizioNxX/Liberty-Way</a></p>
<h3 id="developers"><a name="developers" class="plugin-anchor" href="#developers"><i class="fa fa-link" aria-hidden="true"></i></a>Developers</h3>
<ul>
<li><a href="mailto:xxoinvizionxx@gmail.com" target="_blank">Pavel Neshumov</a></li>
<li><a href="mailto:astik452@gmail.com" target="_blank">Andrey Kabalin</a></li>
<li><a href="mailto:vlad.yasn@gmail.com" target="_blank">Vladislav Yasnetsky</a></li>
</ul>
<p><img src="../assets/amls/drone_meme.jpg" alt="Drone 1" title="Drone 1"></p>
<hr>
<h2 id="table-of-contents"><a name="table-of-contents" class="plugin-anchor" href="#table-of-contents"><i class="fa fa-link" aria-hidden="true"></i></a>Table of contents</h2>
<ul>
<li><a href="#how-does-it-work">0. How does it work?</a><ul>
<li><a href="#short-video-about-our-project-clickable">0.1. A video about our project</a></li>
</ul>
</li>
<li><a href="#hold-and-flight-to-waypoints-functions">1. GPS hold and Flight to waypoints functions</a><ul>
<li><a href="#serial-reading">1.1. Serial reading</a></li>
<li><a href="#ublox-parsing">1.2. UBlox GPS parsing</a></li>
<li><a href="#set-current-waypoint">1.3. Set current waypoint</a></li>
<li><a href="#waypoint-edit-to-fly-to-waypoints">1.4. Waypoint edition (To fly to waypoints)</a></li>
<li><a href="#waypoint-stabilization">1.5. Waypoint stabilization</a></li>
</ul>
</li>
<li><a href="#following">2. GPS following</a></li>
<li><a href="#compass">3. Compass</a></li>
<li><a href="#altitude-stabilization-barometer">4. Altitude stabilization (barometer)</a></li>
<li><a href="#optical-stabilization">5. Optical stabilization</a><ul>
<li><a href="#so-difficult-and-so-important">5.1. So difficult and so important</a></li>
<li><a href="#first-steps">5.2. First steps</a></li>
<li><a href="#inverse-approach">5.3. Inverse approach</a></li>
<li><a href="#java-edition">5.4. Java edition</a></li>
<li><a href="#liberty-way">5.5. Liberty-Way</a></li>
<li><a href="#communication-with-the-drone">5.6. Communication with the drone</a></li>
<li><a href="#camera-gimbal">5.7. Camera gimbal</a></li>
</ul>
</li>
<li><a href="#eitude-amls-platform">6. Eitude AMLS Platform</a><ul>
<li><a href="#grabbing-system">6.1. Grabbing system</a></li>
<li><a href="#weather-protection-system">6.2. Weather protection system</a></li>
<li><a href="#platform-speedometer">6.3. Speed measurement system</a></li>
<li><a href="#platform-light-sensor">6.4. Illumination system</a></li>
</ul>
</li>
<li><a href="#conclusion">7. Conclusion</a></li>
</ul>
<hr>
<h2 id="how-does-it-work"><a name="how-does-it-work" class="plugin-anchor" href="#how-does-it-work"><i class="fa fa-link" aria-hidden="true"></i></a>0. How does it work? </h2>
<p>The AMLS system consists of two parts:</p>
<ul>
<li><p>The drone</p>
<p>  <img src="../assets/amls/liberty-x_side_cutout_2_small.png" alt="Liberty-X" title="Liberty-X"></p>
</li>
<li><p>And the platform either mobile (implemented on a vehicle), either stable (pick-up-point)</p>
<p>  <img src="../assets/amls/platform_side_transparent.png" alt="Platform" title="Platform"></p>
</li>
</ul>
<p>How the system operates:</p>
<ul>
<li>Firstly, a drone with a delivery package is far from the platform and it has no visual contact with it. The drone recieves GPS coordinates of a platform by using cellular communication or any other radio channel (The drone has Liberty-Link implemented on it. This module is able to adjust its position, whatever the firmware of the flight controller. The module is installed inside the line between a receiver and a flight controller.</li>
<li>The drone is moving to received coordinates. The coordinates might be renewed in the process (but not frequently, thus preventing the channel from overloading)</li>
<li>When the drone is close to the platform but there is still no visual contact, the program runs GPS stabilization. Here the data is being transmitted over the closest radio communication channel of high freqency, so the drone can catch up with the platform.</li>
<li>Meanwhile, the drone descends (barometers are installed on both, the drone and the platform). Descending goes on untill altitude reaches 1.5-2 meters above the platform.</li>
<li>While descending and when visual contact with the platform camera is established, the program enables visual (precision) stabilization. And as soon as the drone&apos;s tag is within camera&apos;s field of view, the algorithm will capture the drone.</li>
<li>When optical stabilization is enabled, GPS is working as a back up plan (in case something goes wrong, GPS stabilization launches again).</li>
<li>In order to use optical stabilization the drone is equipped with ArUco tag which can be captured by a camera and by using the closest radio communication channel, the system transmits adjustment data to the drone.</li>
<li>Along with optical stabilization, the program launches landing algorithm. The algorithm artificially and smoothly reduces the setpoint of height (Z) until it reaches a certain threshold.</li>
<li>When the drone is approaching on the desirable height, the program enables grabbing system implemented on the platform. Those grips are used to catch and hold the drone in the process of landing and after the drone was caught.</li>
<li>When the landing is completed, the platform starts maintenance work and in order to protect the drone frome external influences, the program enables weather protection and closes the roof above landing area.</li>
<li>Landing accomplished!  </li>
</ul>
<h3 id="short-video-about-our-project-clickable"><a name="short-video-about-our-project-clickable" class="plugin-anchor" href="#short-video-about-our-project-clickable"><i class="fa fa-link" aria-hidden="true"></i></a>Short video about our project (clickable) </h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/6qjS-iq6a3k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2 id="hold-and-flight-to-waypoints-functions"><a name="hold-and-flight-to-waypoints-functions" class="plugin-anchor" href="#hold-and-flight-to-waypoints-functions"><i class="fa fa-link" aria-hidden="true"></i></a>1. GPS hold and Flight to waypoints functions </h2>
<p>At the beginning, the drone with the package is far from the platform. Then via cellular communication or another suitable radio channel, platform GPS coordinates are sent to the drone (the Liberty-Link module is installed on the drone, this module is capable of correcting its position, regardless of the firmware of the flight controller. (The module is placed between the receiver (RC) and the flight controller)</p>
<p>GPS module will be built in Liberty-Link, so it would have the ability to maintain the drone&apos;s GPS position and follow GPS points.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/x364giIt6lc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>GPS-module will be used from the UBlox group (for instance, UBlox Neo-M8). There will be 1 or 3 (to minimize the error) modules.</p>
<p><img src="../assets/amls/liberty-x_front_cutout_2_small_gps.png" alt="GPS Module" title="GPS Module"></p>
<p>Modules operate via UART, configured to send data 5 times per second. The Liberty-Link firmware will read data from the modules and calculate the coordinates of the current position.</p>
<h3 id="serial-reading"><a name="serial-reading" class="plugin-anchor" href="#serial-reading"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. Serial reading </h3>
<p>Reading data from a module into a buffer looks like this:</p>
<pre><code class="lang-cpp"><span class="hljs-comment">// Read data from the GPS module</span>
<span class="hljs-keyword">while</span> (GPS_serial.available() &amp;&amp; new_line_found == <span class="hljs-number">0</span>) {
    <span class="hljs-comment">// Stay in this loop as long as there is serial information from the GPS available</span>
    <span class="hljs-keyword">char</span> read_serial_byte = GPS_serial.read();
    <span class="hljs-keyword">if</span> (read_serial_byte == <span class="hljs-string">&apos;$&apos;</span>) {
        <span class="hljs-comment">// Clear the old data from the incoming buffer array if the new byte equals a $ character</span>
        <span class="hljs-keyword">for</span> (message_counter = <span class="hljs-number">0</span>; message_counter &lt;= <span class="hljs-number">99</span>; message_counter++) {
            incoming_message[message_counter] = <span class="hljs-string">&apos;-&apos;</span>;
        }
        <span class="hljs-comment">// Reset the message_counter variable because we want to start writing at the begin of the array</span>
        message_counter = <span class="hljs-number">0</span>;
    }
    <span class="hljs-comment">// If the received byte does not equal a $ character, increase the message_counter variable</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (message_counter &lt;= <span class="hljs-number">99</span>)
        message_counter++;

    <span class="hljs-comment">// Write the new received byte to the new position in the incoming_message array</span>
    incoming_message[message_counter] = read_serial_byte;

    <span class="hljs-comment">// Every NMEA line ends with a &apos;*&apos;. If this character is detected the new_line_found variable is set to 1</span>
    <span class="hljs-keyword">if</span> (read_serial_byte == <span class="hljs-string">&apos;*&apos;</span>) new_line_found = <span class="hljs-number">1</span>;
}
</code></pre>
<h3 id="ublox-parsing"><a name="ublox-parsing" class="plugin-anchor" href="#ublox-parsing"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. UBlox GPS parsing </h3>
<p>After that, latitude, longitude, a type of correction (2D, 3D) and the number of satellites are calculated from the filled buffer.
Parsing GPS data of the UBlox protocol looks like this:</p>
<pre><code class="lang-cpp"><span class="hljs-comment">// If the software has detected a new NMEA line it will check if it&apos;s a valid line that can be used</span>
<span class="hljs-keyword">if</span> (new_line_found == <span class="hljs-number">1</span>) {
    <span class="hljs-comment">// Reset the new_line_found variable for the next line</span>
    new_line_found = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (incoming_message[<span class="hljs-number">4</span>] == <span class="hljs-string">&apos;L&apos;</span> &amp;&amp; incoming_message[<span class="hljs-number">5</span>] == <span class="hljs-string">&apos;L&apos;</span> &amp;&amp; incoming_message[<span class="hljs-number">7</span>] == <span class="hljs-string">&apos;,&apos;</span>) {
        <span class="hljs-comment">// When there is no GPS fix or latitude/longitude information available</span>
        <span class="hljs-comment">// Set some variables to 0 if no valid information is found by the GPS module. This is needed for the GPS loss when flying</span>
        l_lat_gps = <span class="hljs-number">0</span>;
        l_lon_gps = <span class="hljs-number">0</span>;
        lat_gps_previous = <span class="hljs-number">0</span>;
        lon_gps_previous = <span class="hljs-number">0</span>;
        number_used_sats = <span class="hljs-number">0</span>;
    }
    <span class="hljs-comment">// If the line starts with GA and if there is a GPS fix we can scan the line for the latitude, longitude and number of satellites</span>
    <span class="hljs-keyword">if</span> (incoming_message[<span class="hljs-number">4</span>] == <span class="hljs-string">&apos;G&apos;</span> &amp;&amp; incoming_message[<span class="hljs-number">5</span>] == <span class="hljs-string">&apos;A&apos;</span> &amp;&amp; (incoming_message[<span class="hljs-number">44</span>] == <span class="hljs-string">&apos;1&apos;</span> || incoming_message[<span class="hljs-number">44</span>] == <span class="hljs-string">&apos;2&apos;</span>)) {
        <span class="hljs-comment">// Filter the minutes for the GGA line multiplied by 10</span>
        lat_gps_actual = ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">19</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">10000000</span>;
        lat_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">20</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">1000000</span>;
        lat_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">22</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">100000</span>;
        lat_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">23</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">10000</span>;
        lat_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">24</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">1000</span>;
        lat_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">25</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">100</span>;
        lat_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">26</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">10</span>;
        <span class="hljs-comment">// To convert minutes to degrees we need to divide minutes by 6</span>
        lat_gps_actual /= (<span class="hljs-keyword">long</span>)<span class="hljs-number">6</span>;
        <span class="hljs-comment">// Add multiply degrees by 10</span>
        lat_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">17</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">100000000</span>;
        lat_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">18</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">10000000</span>;
        <span class="hljs-comment">// Divide everything by 10</span>
        lat_gps_actual /= <span class="hljs-number">10</span>;

        <span class="hljs-comment">// Filter minutes for the GGA line multiplied by 10</span>
        lon_gps_actual = ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">33</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">10000000</span>;
        lon_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">34</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">1000000</span>;
        lon_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">36</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">100000</span>;
        lon_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">37</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">10000</span>;
        lon_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">38</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">1000</span>;
        lon_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">39</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">100</span>;
        lon_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">40</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">10</span>;
        <span class="hljs-comment">// To convert minutes to degrees we need to divide minutes by 6</span>
        lon_gps_actual /= (<span class="hljs-keyword">long</span>)<span class="hljs-number">6</span>;
        <span class="hljs-comment">// Add multiply degrees by 10</span>
        lon_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">30</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">1000000000</span>;
        lon_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">31</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">100000000</span>;
        lon_gps_actual += ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">32</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">10000000</span>;
        <span class="hljs-comment">// Divide everything by 10</span>
        lon_gps_actual /= <span class="hljs-number">10</span>;

        <span class="hljs-keyword">if</span> (incoming_message[<span class="hljs-number">28</span>] == <span class="hljs-string">&apos;N&apos;</span>)
            <span class="hljs-comment">// When flying north of the equator the latitude_north variable will be set to 1</span>
            latitude_north = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">else</span>
            <span class="hljs-comment">// When flying south of the equator the latitude_north variable will be set to 0</span>
            latitude_north = <span class="hljs-number">0</span>;

        <span class="hljs-keyword">if</span> (incoming_message[<span class="hljs-number">42</span>] == <span class="hljs-string">&apos;E&apos;</span>)
            <span class="hljs-comment">// When flying east of the prime meridian the longiude_east variable will be set to 1</span>
            longiude_east = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">else</span>
            <span class="hljs-comment">// When flying west of the prime meridian the longiude_east variable will be set to 0</span>
            longiude_east = <span class="hljs-number">0</span>;

        <span class="hljs-comment">// Filter the number of satillites from the GGA line</span>
        number_used_sats = ((<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">46</span>] - <span class="hljs-number">48</span>) * (<span class="hljs-keyword">long</span>)<span class="hljs-number">10</span>;
        number_used_sats += (<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">47</span>] - <span class="hljs-number">48</span>;

        <span class="hljs-keyword">if</span> (lat_gps_previous == <span class="hljs-number">0</span> &amp;&amp; lon_gps_previous == <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// If this is the first time the GPS code is used</span>
            <span class="hljs-comment">// Set the lat_gps_previous variable to the lat_gps_actual variable</span>
            lat_gps_previous = lat_gps_actual;
            <span class="hljs-comment">// Set the lon_gps_previous variable to the lon_gps_actual variable</span>
            lon_gps_previous = lon_gps_actual;
        }

        <span class="hljs-comment">// Divide the difference between the new and the previous latitudes by 10</span>
        lat_gps_loop_add = (<span class="hljs-keyword">float</span>)(lat_gps_actual - lat_gps_previous) / <span class="hljs-number">10.0</span>;
        <span class="hljs-comment">// Divide the difference between the new and the previous longitudes by 10</span>
        lon_gps_loop_add = (<span class="hljs-keyword">float</span>)(lon_gps_actual - lon_gps_previous) / <span class="hljs-number">10.0</span>;

        <span class="hljs-comment">// Set the l_lat_gps variable to the previous latitude value</span>
        l_lat_gps = lat_gps_previous;
        <span class="hljs-comment">// Set the l_lon_gps variable to the previous longitude value</span>
        l_lon_gps = lon_gps_previous;

        <span class="hljs-comment">// Remember the new latitude value in the lat_gps_previous variable for the next loop</span>
        lat_gps_previous = lat_gps_actual;
        <span class="hljs-comment">// Remember the new longitude value in the lat_gps_previous variable for the next loop</span>
        lon_gps_previous = lon_gps_actual;
    }

    <span class="hljs-comment">// If the line starts with SA and if there is a GPS fix we can scan the line for the fix type (none, 2D or 3D)</span>
    <span class="hljs-keyword">if</span> (incoming_message[<span class="hljs-number">4</span>] == <span class="hljs-string">&apos;S&apos;</span> &amp;&amp; incoming_message[<span class="hljs-number">5</span>] == <span class="hljs-string">&apos;A&apos;</span>)
        fix_type = (<span class="hljs-keyword">int</span>)incoming_message[<span class="hljs-number">9</span>] - <span class="hljs-number">48</span>;

}
</code></pre>
<h3 id="set-current-waypoint"><a name="set-current-waypoint" class="plugin-anchor" href="#set-current-waypoint"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. Set current waypoint </h3>
<p>When required data is received the main magic happens. To enable maintaining of the current position it will be enough to set the flag <code>waypoint_set = 1;</code> and set current coordinates as a waypoint:</p>
<pre><code class="lang-cpp">l_lat_waypoint = l_lat_gps;
l_lon_waypoint = l_lon_gps;
</code></pre>
<p>After that, the calculation of the error in the coordinates will begin, correction works with the help of a PD - regulator. For D - component we use rotation memory.</p>
<h3 id="waypoint-edit-to-fly-to-waypoints"><a name="waypoint-edit-to-fly-to-waypoints" class="plugin-anchor" href="#waypoint-edit-to-fly-to-waypoints"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. Waypoint edit (To fly to waypoints) </h3>
<p>If you just set the new <code>l_lat_waypoint</code> and <code>l_lon_wayoint</code>, which are located at a great distance from the drone, the drone will not be able to fly normally and stabilize at these coordinates. For smooth adjustments <code>l_lat_gps_float_adjust</code> and <code>l_lon_gps_float_adjust</code> can be used. These are <code>float</code> variables, changing which will smoothly shift <code>l_lat_waypoint</code> and <code>l_lon_waypoint</code>.</p>
<p>For example, if in the main loop you will constantly add a certain value to these variables:</p>
<pre><code class="lang-cpp">l_lat_gps_float_adjust += <span class="hljs-number">0.0015</span>;
</code></pre>
<p>With set waypoint, the drone will move smoothly in the given direction.
In the future, this will be used for the smooth drone&apos;s acceleration and deceleration while moving to its destination.</p>
<h3 id="waypoint-stabilization"><a name="waypoint-stabilization" class="plugin-anchor" href="#waypoint-stabilization"><i class="fa fa-link" aria-hidden="true"></i></a>1.5. Waypoint stabilization </h3>
<pre><code class="lang-cpp">if (waypoint_set == 1) {
    //If the waypoints are stored

    // Adjust l_lat_waypoint
    if (l_lat_gps_float_adjust &gt; 1) {
        l_lat_waypoint++;
        l_lat_gps_float_adjust--;
    }
    if (l_lat_gps_float_adjust &lt; -1) {
        l_lat_waypoint--;
        l_lat_gps_float_adjust++;
    }

    // Adjust l_lon_waypoint
    if (l_lon_gps_float_adjust &gt; 1) {
        l_lon_waypoint++;
        l_lon_gps_float_adjust--;
    }
    if (l_lon_gps_float_adjust &lt; -1) {
        l_lon_waypoint--;
        l_lon_gps_float_adjust++;
    }

    // Calculate the latitude error between waypoint and actual position
    gps_lon_error = l_lon_waypoint - l_lon_gps;
    // Calculate the longitude error between waypoint and actual position
    gps_lat_error = l_lat_gps - l_lat_waypoint;

    // Subtract the current memory position to make room for the new value
    gps_lat_total_avarage -= gps_lat_rotating_mem[gps_rotating_mem_location];
    // Calculate the new change between the actual pressure and the previous measurements
    gps_lat_rotating_mem[gps_rotating_mem_location] = gps_lat_error - gps_lat_error_previous;
    // Add the new value to the long term average value
    gps_lat_total_avarage += gps_lat_rotating_mem[gps_rotating_mem_location];

    // Subtract the current memory position to make room for the new value
    gps_lon_total_avarage -= gps_lon_rotating_mem[gps_rotating_mem_location];
    // Calculate the new change between the actual pressure and the previous measurements
    gps_lon_rotating_mem[gps_rotating_mem_location] = gps_lon_error - gps_lon_error_previous;
    // Add the new value to the long term avarage value
    gps_lon_total_avarage += gps_lon_rotating_mem[gps_rotating_mem_location];

    // Increase the rotating memory location
    gps_rotating_mem_location++;
    if (gps_rotating_mem_location == 35)
        // Start at 0 when the memory location 35 is reached
        gps_rotating_mem_location = 0;

    // Remember the error for the next loop
    gps_lat_error_previous = gps_lat_error;
    gps_lon_error_previous = gps_lon_error;

    //Calculate the GPS pitch and roll corrections as if the nose of the multicopter is facing north.
    //The Proportional part = (float)gps_lat_error * gps_p_gain.
    //The Derivative part = (float)gps_lat_total_avarage * gps_d_gain.
    gps_pitch_adjust_north = (float)gps_lat_error * gps_p_gain + (float)gps_lat_total_avarage * gps_d_gain;
    gps_roll_adjust_north = (float)gps_lon_error * gps_p_gain + (float)gps_lon_total_avarage * gps_d_gain;

    if (!latitude_north)
        // Invert the pitch adjustmet because the quadcopter is flying south of the equator
        gps_pitch_adjust_north *= -1;
    if (!longiude_east)
        // Invert the roll adjustmet because the quadcopter is flying west of the prime meridian
        gps_roll_adjust_north *= -1;

    //Because the correction is calculated as if the nose was facing north, we need to convert it for the current heading.
    gps_roll_adjust = ((float)gps_roll_adjust_north * cos(angle_yaw * 0.017453)) + ((float)gps_pitch_adjust_north * cos((angle_yaw - 90) * 0.017453));
    gps_pitch_adjust = ((float)gps_pitch_adjust_north * cos(angle_yaw * 0.017453)) + ((float)gps_roll_adjust_north * cos((angle_yaw + 90) * 0.017453));

    //Limit the maximum correction to 300. This way we still have the full control of the drone with the pitch and roll sticks on the transmitter.
    if (gps_roll_adjust &gt; 300) gps_roll_adjust = 300;
    if (gps_roll_adjust &lt; -300) gps_roll_adjust = -300;
    if (gps_pitch_adjust &gt; 300) gps_pitch_adjust = 300;
    if (gps_pitch_adjust &lt; -300) gps_pitch_adjust = -300;
}
</code></pre>
<h2 id="following"><a name="following" class="plugin-anchor" href="#following"><i class="fa fa-link" aria-hidden="true"></i></a>2. GPS following </h2>
<p>The main part of stabilization using GPS coordinates was the development of an algorithm for predicting the position of the drone. The simplest idea was to use a mathematical calculation of the next drone&apos;s position. This is calculated for the most accurate positioning in relation to the landing platform.</p>
<p>At the beginning we developed a simple algorithm for calculating the coefficient of coordinates&apos; change. The development was done using Python. At the stage of testing this algorithm, the problem of simulating the generation of GPS coordinates arose. To solve this problem, many different resources were used: from open source homemade navigators to trying to use the Google Maps, Yandex Maps or 2GIS APIs.
And only after 3 months, we thought of a simple solution: to change the values with some delta and to visualize using MatPlotLib or PyQtGraph.
Prior to this, all testing of the algorithm was carried out using the PX4 firmware toolkit and the Gazebo drone motion simulator. As a result, many formalities were overcome in terms of communicating with the simulator and increasing performance (click on the picture to see the video).</p>
<p>The result of the GPS prediction (clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Rg-Y_fl4BKQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>The end result reached a point when the error of the predicted position varies from 0 to 70 centimeters.</p>
<hr>
<h2 id="compass"><a name="compass" class="plugin-anchor" href="#compass"><i class="fa fa-link" aria-hidden="true"></i></a>3. Compass </h2>
<p>Before optical stabilization launches (during GPS stabilization process), to calculate the GPS correction vector, you need to know the exact angle from the compass. For this, a compass built into the GPS module is used.</p>
<p>Because during the flight, the roll and pitch angles change and a user needs to correct the values from the compass.
In general, calculating the angle from the compass looks like this:</p>
<pre><code class="lang-cpp">// The compass values change when the roll and pitch angles of the quadcopter change. That&apos;s the reason why the x and y values need to be calculated for a virtual horizontal position
// The 0.0174533 value is phi/180 as the functions are in radians in stead of degrees
compass_x_horizontal = (float)compass_x * cos(angle_pitch * -0.0174533) + (float)compass_y * sin(angle_roll * 0.0174533) * sin(angle_pitch * -0.0174533) - (float)compass_z * cos(angle_roll * 0.0174533) * sin(angle_pitch * -0.0174533);
compass_y_horizontal = (float)compass_y * cos(angle_roll * 0.0174533) + (float)compass_z * sin(angle_roll * 0.0174533);

// Now that the horizontal values are known the heading can be calculated. With the following lines of code the heading is calculated in degrees.
// Please note that the atan2 uses radians in stead of degrees. That is why the 180/3.14 is used.
if (compass_y_horizontal &lt; 0)actual_compass_heading = 180 + (180 + ((atan2(compass_y_horizontal, compass_x_horizontal)) * (180 / 3.14)));
else actual_compass_heading = (atan2(compass_y_horizontal, compass_x_horizontal)) * (180 / 3.14);

// Add the declination to the magnetic compass heading to get the geographic north
actual_compass_heading += declination;
// If the compass heading becomes smaller than 0, 360 is added to keep it in the 0-360 degrees range
if (actual_compass_heading &lt; 0) actual_compass_heading += 360;
// If the compass heading becomes larger then 360, 360 is subtracted to keep it in the 0-360 degrees range
else if (actual_compass_heading &gt;= 360) actual_compass_heading -= 360;
</code></pre>
<p>It is clear that the angle from the compass can also be used to maintain the yaw angle of the drone. With point-to-point flights, this may be realized. But at the moment, there is no urgent need for this, because after the start of optical stabilization, the algorithm is able to correct the drone regardless of its yaw angle. Also, during optical stabilization, the yaw angle is automatically corrected.</p>
<hr>
<h2 id="altitude-stabilization-barometer"><a name="altitude-stabilization-barometer" class="plugin-anchor" href="#altitude-stabilization-barometer"><i class="fa fa-link" aria-hidden="true"></i></a>4. Altitude stabilization (barometer) </h2>
<p>Before optical stabilization launches (during GPS stabilization process), our Liberty-Link module will be able to maintain altitude using a barometer.</p>
<p>The platform, as well as the Liberty-Link, will have MS5611 barometers.</p>
<p><img src="../assets/amls/ms5611_barometer.png" alt="MS5611" title="MS5611"></p>
<p>According to the documentation, the height resolution is 10 cm. The algorithm will take the pressure values and by passing it through the PID-controller will stabilize the drone&apos;s altitude by changing the Throttle (3rd channel).</p>
<p>Altitude hold test (clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/xmvcGeZzEfc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>During the flight along the waypoint, the setpoint of the pressure will decrease in order to increase the altitude (it is safer to fly in a straight line at a high altitude, so the drone would not crash into anything). And during GPS stabilization (when the drone is already close to the platform), the drone will be set with a setpoint of pressure that correlates with ~ 1.5-2m height above the platform.</p>
<hr>
<h2 id="optical-stabilization"><a name="optical-stabilization" class="plugin-anchor" href="#optical-stabilization"><i class="fa fa-link" aria-hidden="true"></i></a>5. Optical stabilization </h2>
<h3 id="so-difficult-and-so-important"><a name="so-difficult-and-so-important" class="plugin-anchor" href="#so-difficult-and-so-important"><i class="fa fa-link" aria-hidden="true"></i></a>5.1. So difficult and so important </h3>
<p>Optical stabilization is the most important and challenging part of our project. In the current condition it is possible to keep the drone above the platform still only using these algorithms. The current version of the OIS algorithm, along with a description of the usage and making, is available in our main GitHub repository. In the future, GPS stabilization will be added to it.</p>
<h3 id="first-steps"><a name="first-steps" class="plugin-anchor" href="#first-steps"><i class="fa fa-link" aria-hidden="true"></i></a>5.2. First steps </h3>
<p>And as we couldn&apos;t predict the possibility of accomplishing our task, first of all, we started to think about the solution for the stabilization system. Afterwards, we settled with the stabilization using augmented reality tags. Firstly, it won&apos;t take much finances as we do not need GPS or RTK systems and it will be accurate enough to accomplish its purpose.
Our first idea was to attach Raspberry Pi with Liberty_X as it was embodied in COEX Clover and to let Raspberry Pi handle all of the maths.</p>
<p>First optical stabilization prototype test (clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/TrrxXOHAqbQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>But few tests showed that Raspberry Pi computing power is not enough for amount of data needed to stabilize the drone. Furthermore, the idea of installing a Raspberry Pi on each drone is irrational for its own.</p>
<p>Also, we had middling prototypes, for example, attempts to use color markers (circles of different colors), but these ideas did not work well enough.</p>
<h3 id="inverse-approach"><a name="inverse-approach" class="plugin-anchor" href="#inverse-approach"><i class="fa fa-link" aria-hidden="true"></i></a>5.3. Inverse approach </h3>
<p>Then we came up with the idea of separating drone and stabilization system so the main math will be accomplished on the landing platform with powerful machine.</p>
<p>This was how we ended up with our current optical stabilization algorithm - the camera which is connected to a powerful machine and the machine is attached to the platform. The drone only has 4x4 ArUco tag and its controller.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/A2oq6zCebVo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Then, we came up with using Pose Estimation algorithms from OpenCV library. The first tests showed us that we are on the right track!</p>
<p>Pose Estimation Python (clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kE3UmJZ00so" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>But, the algorithms were far from perfect. For example, since the code was written in Python (<a href="https://github.com/XxOinvizioNxX/Liberty-X_Point" target="_blank">https://github.com/XxOinvizioNxX/Liberty-X_Point</a>), the performance was not satisfyingly, and there was no suitable threading control either. Therefore, we had to change something.</p>
<h3 id="java-edition"><a name="java-edition" class="plugin-anchor" href="#java-edition"><i class="fa fa-link" aria-hidden="true"></i></a>5.4. Java edition </h3>
<p>Having weighed all the pros and cons, it was decided to rewrite all optical stabilization using Java. This is how the first version of Liberty-Way appeared. This time, it was decided to approach the OOP thoroughly, and, after a little tweaking, an excellent stabilization and landing algorithm was obtained.</p>
<p>Landing test on Liberty-Way v.beta_0.0.1 (clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8VAobWPFG8g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h3 id="liberty-way"><a name="liberty-way" class="plugin-anchor" href="#liberty-way"><i class="fa fa-link" aria-hidden="true"></i></a>5.5. Liberty-Way </h3>
<p>Then many improvements and bug fixes followed. As a result, Liberty-Way is a cross-platform web sarvar application that is very convenient for configuration and debugging. Also, in the latest versions (beta_1.0.3 - beta_1.1.2) a blackbox feature was introduced (for recording logs), as well as communication with the platform and many other necessary algorithms.</p>
<p>Full description, including all settings, startup, etc. you can find in our GitHub repository: <a href="https://github.com/XxOinvizioNxX/Liberty-Way" target="_blank">https://github.com/XxOinvizioNxX/Liberty-Way</a></p>
<p>Video of static stabilization (clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/adR38R27MEU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Liberty-Way can even stabilize a &quot;thrown&quot; drone (clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/gAaGQSC-r2g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>There is a small bug in the video with the rotation angle, in the new release it has been fixed!</p>
<p>And, of course, example of how it works in motion (tested with beta_0.0.3 release) (clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8vB-8QIBoJU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>All basic settings are conveniently placed in separate JSON files (settings, PID), which allows a user to quickly change the required parameters without rebuilding the application. In fact, to run the application, you just need to download the latest release, unpack the archive and run it through the launcher corresponding to the preferable OS.</p>
<h3 id="communication-with-the-drone"><a name="communication-with-the-drone" class="plugin-anchor" href="#communication-with-the-drone"><i class="fa fa-link" aria-hidden="true"></i></a>5.6. Communication with the drone </h3>
<p>The Liberty-Way connects to the Liberty-Link module installed on the drone and adjusts its position by directly controlling four main channels of the remote control. In one cycle (each frame from the camera), 12 bytes of correction data are sent to the module:
<img src="../assets/amls/data_structure.png" alt="Packet" title="Data packet"></p>
<p>Bytes description:</p>
<ul>
<li><strong>Roll bytes</strong> - Roll correction values</li>
<li><strong>Pitch bytes</strong> - Pitch correction values</li>
<li><strong>Yaw bytes</strong> - Yaw correction values</li>
<li><strong>Altitude bytes</strong> - Altitude correction values</li>
<li><strong>Service info</strong> - sets the drone state (0 - Nothing to do, 1 - Stabilization, 2 - Landing (command not implemented and will be removed in the future. This is not a real landing, just to tell the drone to start decreasing altitude), 3 - Disable motors)</li>
<li><strong>Check byte</strong> - XOR sum of all previous bytes that is compared via transmittion in order to verify the data</li>
<li><strong>Data suffix</strong> - unique pair of ASCII symbols that is not represented in the packet in any form and that shows the end of the packet</li>
</ul>
<p>On the drone side (Liberty-Link module), data reading is performing as follows:</p>
<pre><code class="lang-cpp"><span class="hljs-keyword">while</span> (Telemetry_serial.available()) {
    tdc_receive_buffer[tdc_receive_buffer_counter] = Telemetry_serial.read();
    <span class="hljs-keyword">if</span> (tdc_receive_byte_previous == <span class="hljs-string">&apos;L&apos;</span> &amp;&amp; tdc_receive_buffer[tdc_receive_buffer_counter] == <span class="hljs-string">&apos;X&apos;</span>) {
        tdc_receive_buffer_counter = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (tdc_receive_start_detect &gt;= <span class="hljs-number">2</span>) {
            tdc_check_byte = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (tdc_temp_byte = <span class="hljs-number">0</span>; tdc_temp_byte &lt;= <span class="hljs-number">8</span>; tdc_temp_byte++)
                tdc_check_byte ^= tdc_receive_buffer[tdc_temp_byte];
            <span class="hljs-keyword">if</span> (tdc_check_byte == tdc_receive_buffer[<span class="hljs-number">9</span>]) {
                direct_roll_control = (<span class="hljs-keyword">uint32_t</span>)tdc_receive_buffer[<span class="hljs-number">1</span>] | (<span class="hljs-keyword">uint32_t</span>)tdc_receive_buffer[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">8</span>;
                direct_pitch_control = (<span class="hljs-keyword">uint32_t</span>)tdc_receive_buffer[<span class="hljs-number">3</span>] | (<span class="hljs-keyword">uint32_t</span>)tdc_receive_buffer[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span>;
                direct_yaw_control = (<span class="hljs-keyword">uint32_t</span>)tdc_receive_buffer[<span class="hljs-number">5</span>] | (<span class="hljs-keyword">uint32_t</span>)tdc_receive_buffer[<span class="hljs-number">4</span>] &lt;&lt; <span class="hljs-number">8</span>;
                direct_throttle_control = (<span class="hljs-keyword">uint32_t</span>)tdc_receive_buffer[<span class="hljs-number">7</span>] | (<span class="hljs-keyword">uint32_t</span>)tdc_receive_buffer[<span class="hljs-number">6</span>] &lt;&lt; <span class="hljs-number">8</span>;
                direct_service_info = (<span class="hljs-keyword">uint32_t</span>)tdc_receive_buffer[<span class="hljs-number">8</span>];

                <span class="hljs-keyword">if</span> (direct_roll_control &gt; <span class="hljs-number">1100</span> &amp;&amp; direct_roll_control &lt; <span class="hljs-number">1900</span> &amp;&amp;
                    direct_pitch_control &gt; <span class="hljs-number">1100</span> &amp;&amp; direct_pitch_control &lt; <span class="hljs-number">1900</span> &amp;&amp;
                    direct_yaw_control &gt; <span class="hljs-number">1100</span> &amp;&amp; direct_yaw_control &lt; <span class="hljs-number">1900</span> &amp;&amp;
                    direct_throttle_control &gt; <span class="hljs-number">1100</span> &amp;&amp; direct_throttle_control &lt; <span class="hljs-number">1900</span> &amp;&amp;
                    <span class="hljs-comment">/*flight_mode == 2 &amp;&amp;*/</span> channel_7 &gt; <span class="hljs-number">1500</span>) {
                    tdc_timer = millis();
                    tdc_working = <span class="hljs-number">1</span>;
                }
                <span class="hljs-keyword">else</span>
                    tdc_working = <span class="hljs-number">0</span>;
            }
            <span class="hljs-keyword">else</span> {
                direct_roll_control = <span class="hljs-number">1500</span>;
                direct_pitch_control = <span class="hljs-number">1500</span>;
                tdc_working = <span class="hljs-number">0</span>;
            }
        } <span class="hljs-keyword">else</span>
            tdc_receive_start_detect++;
    }
    <span class="hljs-keyword">else</span> {
        tdc_receive_byte_previous = tdc_receive_buffer[tdc_receive_buffer_counter];
        tdc_receive_buffer_counter++;
        <span class="hljs-keyword">if</span> (tdc_receive_buffer_counter &gt; <span class="hljs-number">11</span>)tdc_receive_buffer_counter = <span class="hljs-number">0</span>;
    }
}
<span class="hljs-keyword">if</span> (millis() - tdc_timer &gt;= <span class="hljs-number">500</span>) {
    tdc_working = <span class="hljs-number">0</span>;
}
<span class="hljs-keyword">if</span> (tdc_working &amp;&amp; direct_service_info == <span class="hljs-number">2</span> &amp;&amp; !return_to_home_step)
    return_to_home_step = <span class="hljs-number">3</span>;
<span class="hljs-keyword">if</span> (!tdc_working)
    return_to_home_step = <span class="hljs-number">0</span>;
<span class="hljs-keyword">if</span> (!tdc_working || direct_service_info &lt; <span class="hljs-number">1</span>) {
    direct_roll_control = <span class="hljs-number">1500</span>;
    direct_pitch_control = <span class="hljs-number">1500</span>;
    direct_yaw_control = <span class="hljs-number">1500</span>;
    direct_throttle_control = <span class="hljs-number">1500</span>;
}
</code></pre>
<p>As a result, there are 4 variables:</p>
<pre><code>direct_roll_control
direct_pitch_control
direct_yaw_control
direct_throttle_control
</code></pre><p>Which are directly added to the data received from the control panel.
Probably, in the future, other data will be added, at least for working with GPS. Stay tuned for updates in our repository.</p>
<h3 id="camera-gimbal"><a name="camera-gimbal" class="plugin-anchor" href="#camera-gimbal"><i class="fa fa-link" aria-hidden="true"></i></a>5.7. Camera gimbal </h3>
<p>To operate our system in real conditions, it is required to minimize camera shaking if we don&apos;t want to lose the tag on the drone. For that reason, a 3D model of a gimbal for attaching the drone to the platform was developed to stabilize a conventional webcam.</p>
<p>Camera mount:</p>
<p> <img src="../assets/amls/gimbal_camera_mount.png" alt="Camera mount" title="Camera mount"></p>
<p>Camera wire fixing (ferrite filter on the wire):</p>
<p> <img src="../assets/amls/gimbal_filter_mount.png" alt="Filter mount" title="Filter mount"></p>
<p>Fixing of the &quot;crabs&quot; latches on the suspension substrate:</p>
<p> <img src="../assets/amls/gimbal_plane_mount.png" alt="Plane mount" title="Plane mount"></p>
<p>An approximate view of the assembly of the entire suspension mechanism:</p>
<p> <img src="../assets/amls/gimbal_assembly.png" alt="Assembly" title="Assembly"></p>
<hr>
<h2 id="eitude-amls-platform"><a name="eitude-amls-platform" class="plugin-anchor" href="#eitude-amls-platform"><i class="fa fa-link" aria-hidden="true"></i></a>6. Eitude AMLS Platform </h2>
<p>The platform is an interconnected system for landing the drone. The platform was planned to be controlled via the Serial interface, using the G-Code commands: The current platform code can be found in the Eitude GitHub repository: <a href="https://github.com/XxOinvizioNxX/Eitude" target="_blank">https://github.com/XxOinvizioNxX/Eitude</a></p>
<h3 id="grabbing-system"><a name="grabbing-system" class="plugin-anchor" href="#grabbing-system"><i class="fa fa-link" aria-hidden="true"></i></a>6.1. Grabbing system </h3>
<p>As you may know it doesn&apos;t matter how good is our stabilization, without grabbing system the drone will crash eventually. Hence we developed a 3D model of a grabbing system with 4 grips that have a hook at the end of each one. This will allow the system to slowly grab the drone while it lands and hold it steady after landing.</p>
<p><img src="../assets/amls/grabbing_system_1.png" alt="Screenshot" title="Screenshot"></p>
<p><img src="../assets/amls/grabbing_system_2.png" alt="Screenshot" title="Screenshot"></p>
<h3 id="weather-protection-system"><a name="weather-protection-system" class="plugin-anchor" href="#weather-protection-system"><i class="fa fa-link" aria-hidden="true"></i></a>6.2. Weather protection system </h3>
<p>As for the weather protection, we developed a 3D model to create a roof that will protect the drone from weather conditions while it is on the platform.
The AMLS weather protection system consists of scissor-like mechanisms covered with a canvas, which are located around the edges of the platform.
After a successful landing, the mechanisms on both sides of the platform close and protect the drone from external influences. The roof structure itself makes it light and strong, and the scissor-like mechanisms allow it to simply fold and unfold itself. Moreover, the assembly of such mechanisms will be simple and reliable.</p>
<p><img src="../assets/amls/platform_side_transparent.png" alt="Screenshot" title="Screenshot"></p>
<p><img src="../assets/amls/platform_roof.png" alt="Screenshot" title="Screenshot"></p>
<h3 id="platform-speedometer"><a name="platform-speedometer" class="plugin-anchor" href="#platform-speedometer"><i class="fa fa-link" aria-hidden="true"></i></a>6.3. Platform speedometer </h3>
<p>In order to land on a quickly moving platform, it is very useful to know its speed. For now, the platform does not have a GPS module, or any other way to measure absolute speed. Therefore, for a temporary solution to this problem, it was decided to calculate the speed using an accelerometer. For example, MPU6050. The IMU is mounted into the prototype platform through a soft backing and it&apos;s covered with a cap to protect it from the wind. The stabilization algorithm (Liberty-Way) sends a request to the platform <code>L1</code> to test the speed. A message <code>S0 L &lt;speed in km / h&gt;</code> is returned as a response.</p>
<p><img src="../assets/amls/mpu6050_gyro.png" alt="MPU6050" title="MPU6050"></p>
<p>Speedometer test (inside the gray circle, lower right parameter (SPD) - speed in km / h) (Clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/yvCo6tYjdM0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>To calculate the speed, the acceleration is taken for short time periods, then multiplied with time, which results with the instantaneous speed. Then this speed is constantly added to the previous value:</p>
<pre><code class="lang-cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">speed_handler</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{
    gyro_signalen();

    <span class="hljs-comment">// Filter accelerations</span>
    acc_x_filtered = (<span class="hljs-keyword">float</span>)acc_x_filtered * ACC_FILTER_KOEFF + (<span class="hljs-keyword">float</span>)acc_x * (<span class="hljs-number">1.0</span> - ACC_FILTER_KOEFF);

    speed = acc_x_filtered;
    <span class="hljs-comment">// Convert acceleration to G</span>
    speed /= <span class="hljs-number">4096.0</span>;
    <span class="hljs-comment">// Convert to m/s^2</span>
    speed *= <span class="hljs-number">9.81</span>;
    <span class="hljs-comment">// Multiply by dt to get instant speed in m/ms</span>
    speed *= (millis() - speed_loop_timer);

    <span class="hljs-comment">// Reset timer</span>
    speed_loop_timer = millis();

    <span class="hljs-comment">// Convert to m/s</span>
    speed /= <span class="hljs-number">1000.0</span>;
    <span class="hljs-comment">// Convert to km/h</span>
    speed *= <span class="hljs-number">3.6</span>;

    <span class="hljs-comment">// Accumulate instantaneous speed</span>
    speed_accumulator += speed;

    <span class="hljs-keyword">if</span> (!in_move_flag) {
        <span class="hljs-comment">// If the platform is not moving, reset the speed</span>
        speed_accumulator = speed_accumulator * SPEED_ZEROING_FACTOR;
    }
}
</code></pre>
<p>Despite having various filters, due to the error, the speed may not &quot;return&quot; to 0, therefore, vibrations are also measured, and if they are less than the certain threshold, it is considered that the platform is at a standstill and the speed gradually resets to zero.</p>
<p>The complete code of the speedometer can be found in the Eitude repository on GitHub: <a href="https://github.com/XxOinvizioNxX/Eitude" target="_blank">https://github.com/XxOinvizioNxX/Eitude</a></p>
<h3 id="platform-light-sensor"><a name="platform-light-sensor" class="plugin-anchor" href="#platform-light-sensor"><i class="fa fa-link" aria-hidden="true"></i></a>6.4. Platform light sensor </h3>
<p>As our platform must work in various environmental conditions, and optical stabilization is very demanding on the visibility of the ArUco marker, it is important to have an automatic system for measuring the camera exposure by the level of illumination around it, and turning on additional illumination if there is a lack of lighting. In the long term, it is planned to use specialized sensors, for example, the BH1750, as light sensors.</p>
<p>In the current version of the prototype, 6 LEDs are used as a light sensor and an ADC built into the microcontroller. The stabilization algorithm (Liberty-Way) sends a request <code>L0</code> to the platform to check the illumination level. A message <code>S0 L &lt;luminance&gt;</code> is returned as a response.</p>
<p><img src="../assets/amls/light_sensors.png" alt="Light sensors" title="Light sensors"></p>
<p>Test for determining the level of illumination using LEDs (clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/xQeiA945aRA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Exposure adjustment and adding additional illumination tests (clickable):</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/iMORim6zxsg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<hr>
<h2 id="conclusion"><a name="conclusion" class="plugin-anchor" href="#conclusion"><i class="fa fa-link" aria-hidden="true"></i></a>7. Conclusion </h2>
<p>At the moment, there is a debugged prototype of optical stabilization, GPS holding, altitude stabilization via barometer, different platform prototypes and a great amount of 3D models eager to be constructed.
The project of the automatical landing of a drone onto a moving platform is not yet complete.</p>
<p>Follow the updates:</p>
<ul>
<li>In our repository GitHub: <a href="https://github.com/XxOinvizioNxX/Liberty-Way" target="_blank">https://github.com/XxOinvizioNxX/Liberty-Way</a></li>
<li>On our YouTube channel: <a href="https://www.youtube.com/channel/UCqN12Jzy-1eJLkcA32R0jdg" target="_blank">https://www.youtube.com/channel/UCqN12Jzy-1eJLkcA32R0jdg</a></li>
</ul>
<p>In the future, we plan to do much more new and interesting stuff!</p>
<p><img src="../assets/amls/follow_the_white_rabbit.png" alt="Follow the white rabbit" title="Follow the white rabbit"></p>
<p><footer id="page-footer" class="localized-footer"><!-- markdownlint-disable MD041 -->
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank"><img src="../assets/cc-by-nc-sa.svg"></a>
This documentation is licensed under the <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>
</footer></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="projects.html" class="navigation navigation-prev " aria-label="Previous page: Clover-based projects">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="clever-show.html" class="navigation navigation-next " aria-label="Next page: Drone show">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Autonomous Multirotor Landing System (AMLS)","level":"1.11.1","depth":2,"next":{"title":"Drone show","level":"1.11.2","depth":2,"path":"clever-show.md","ref":"clever-show.md","articles":[]},"previous":{"title":"Clover-based projects","level":"1.11","depth":1,"path":"projects.md","ref":"projects.md","articles":[{"title":"Autonomous Multirotor Landing System (AMLS)","level":"1.11.1","depth":2,"path":"amls.md","ref":"amls.md","articles":[]},{"title":"Drone show","level":"1.11.2","depth":2,"path":"clever-show.md","ref":"clever-show.md","articles":[]},{"title":"Innopolis Open 2020 (L22_ÆRO)","level":"1.11.3","depth":2,"path":"innopolis_open_L22_AERO.md","ref":"innopolis_open_L22_AERO.md","articles":[]},{"title":"Copter spheric guard","level":"1.11.4","depth":2,"path":"shield.md","ref":"shield.md","articles":[]},{"title":"Face recognition system","level":"1.11.5","depth":2,"path":"face_recognition.md","ref":"face_recognition.md","articles":[]},{"title":"Android RC app","level":"1.11.6","depth":2,"path":"android.md","ref":"android.md","articles":[]},{"title":"3D-scanning drone","level":"1.11.7","depth":2,"path":"3dscan.md","ref":"3dscan.md","articles":[]},{"title":"Human pose estimation drone control","level":"1.11.8","depth":2,"path":"human_pose_estimation_drone_control.md","ref":"human_pose_estimation_drone_control.md","articles":[]},{"title":"Robocross-2019","level":"1.11.9","depth":2,"path":"robocross2019.md","ref":"robocross2019.md","articles":[]},{"title":"Camera calibration (legacy)","level":"1.11.10","depth":2,"path":"camera_calib.md","ref":"camera_calib.md","articles":[]},{"title":"Recognition of crop types in agriculture","level":"1.11.11","depth":2,"path":"agriculture.md","ref":"agriculture.md","articles":[]},{"title":"Drones to fight Coronavirus","level":"1.11.12","depth":2,"path":"anticorona_drones.md","ref":"anticorona_drones.md","articles":[]},{"title":"D-drone Copter Hack 2021 by AT Makers","level":"1.11.13","depth":2,"path":"ddrone.md","ref":"ddrone.md","articles":[]},{"title":"3D-printed Generative Design Frame","level":"1.11.14","depth":2,"path":"generative_design_frame.md","ref":"generative_design_frame.md","articles":[]},{"title":"Retail Drone","level":"1.11.15","depth":2,"path":"bennie.md","ref":"bennie.md","articles":[]},{"title":"The Indoor Mapping Drone","level":"1.11.16","depth":2,"path":"dromap.md","ref":"dromap.md","articles":[]},{"title":"Seeding Drone","level":"1.11.17","depth":2,"path":"seeding_drone.md","ref":"seeding_drone.md","articles":[]},{"title":"Blue Jay Eindhoven","level":"1.11.18","depth":2,"path":"blue_jay_eindhoven.md","ref":"blue_jay_eindhoven.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["richquotes@https://github.com/okalachev/gitbook-plugin-richquotes.git","yametrika","anchors","collapsible-menu","validate-links@https://github.com/okalachev/gitbook-plugin-validate-links.git","bulk-redirect@https://github.com/okalachev/gitbook-plugin-bulk-redirect.git","sitemap@https://github.com/okalachev/plugin-sitemap.git","toolbar@https://github.com/hamishwillee/gitbook-plugin-toolbar.git","addcssjs","localized-footer@https://github.com/okalachev/gitbook-plugin-localized-footer.git","image-zoom@https://github.com/okalachev/gitbook-plugin-image-zoom.git","language-picker@https://github.com/okalachev/gitbook-plugin-language-picker.git"],"root":".","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"yametrika":{"id":49359238},"validate-links":{"remote":"disabled","local":"warn","defaultScheme":"https"},"collapsible-menu":{},"language-picker":{"grid-columns":3,"languages":[["ru","Russian"],["en","English"]]},"image-zoom":{},"search":{},"addcssjs":{"js":["../clover.js"],"css":["../clover.css"]},"localized-footer":{"hline":false,"filename":"./FOOTER.md"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"richquotes":{},"highlight":{},"sitemap":{"hostname":"https://clover.coex.tech"},"bulk-redirect":{"basepath":"","redirectsFile":"redirects.json","blank":true},"toolbar":{"buttons":[{"label":"Edit page on github","icon":"fa fa-pencil-square-o","position":"left","url":"https://github.com/CopterExpress/clover/edit/master/docs/{{filepath_lang}}"},{"label":"GitHub","icon":"fa fa-github","position":"left","url":"https://github.com/CopterExpress/clover"}]},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"theme":"default","author":"Copter Express","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"_GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Clover","language":"en","gitbook":"*","description":"Конструктор квадрокоптера «Клевер»"},"file":{"path":"amls.md","mtime":"2021-11-01T17:11:57.822Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-11-01T17:14:52.024Z"},"basePath":".","book":{"language":"en"}});
        });
    </script>
</div>

        
    
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-yametrika/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-toolbar/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-image-zoom/zoom.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-language-picker/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    
    <script type="text/javascript" src="../clover.js"></script>
    

    <script type='text/javascript'>
        (function (d, w, c) {
            (w[c] = w[c] || []).push(function() {
                try {
                    w.yaCounter49359238 = new Ya.Metrika({"id":49359238});
                } catch(e) { }
            });
            var n = d.getElementsByTagName('script')[0],
                s = d.createElement('script'),
                f = function () {
                    n.parentNode.insertBefore(s, n);
                };

            s.type = 'text/javascript';
            s.async = true;
            s.src = (d.location.protocol == 'https:' ? 'https:' : 'http:') + '//mc.yandex.ru/metrika/watch.js';
            if (w.opera == '[object Opera]') {
                d.addEventListener('DOMContentLoaded', f, false);
            } else {
                f();
            }
        })(document, window, 'yandex_metrika_callbacks');
    </script>
    <noscript>
        <div>
            <img src="//mc.yandex.ru/watch/49359238" style="position:absolute; left:-9999px;" alt=""/>
        </div>
    </noscript>

    </body>
</html>

